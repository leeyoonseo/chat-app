"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var LayerPopup=function(){function a(e,t){if(_classCallCheck(this,a),this.name="LayerPopup",this.options={appendPosition:"body",className:"popup",title:"title",content:"please write your message...",button:!0,dim:!0,scroll:!0,expire:!1,expireData:{date:1,id:"day",label:"하루동안보지않기"},closeButton:!0,closeButtonData:{src:"",label:"x"},customButton:!1,customButtonData:[{type:"",className:"",label:"",event:""}]},e)if("object"===_typeof(e))this.options=Object.assign({},this.options,e),this.callback=t||"";else{if("function"!=typeof e)return console.log("error : 옵션 값을 확인해주세요."),!1;this.callback=e}this._initialize()}return _createClass(a,[{key:"_initialize",value:function(){var s=this,e=this.options,t=e.className,a=e.closeButton,i=e.closeButtonData,n=e.button,o=e.customButton,r=e.title,l=e.dim,c=e.expire,p=e.expireData,u=this._createElement;if(this.wrap=u({className:t+"_wrap",expire:c}),this.wrapInner=u({className:t+"_inner",expire:c}),this.container=u({className:t+"_container",expire:c}),this.content=u({tag:"div",className:t+"_content",expire:c}),this.dim=document.querySelector('[data-type="dim"]'),l&&!this.dim&&(this.dim=u({className:t+"_dim",expire:c})),(r||a)&&(this.header=u({className:t+"_header",expire:c})),r&&(this.title=u({tag:"p",className:t+"_title",expire:c})),a){var h=""===i.label?"x":i.label;this.closeButton=u({tag:"button",className:t+"_close",label:h,src:i.src,expire:c})}if((n||c)&&(this.buttonsWrap=u({tag:"div",className:t+"_buttons_wrap",expire:c}),this.footer=u({className:t+"_footer",expire:c})),n)if(o){var d=this,m=this.options,f=m.customButtonData,y=m.expire;if(""===f)D.call(this);else if(Array.isArray(f)&&1<f.length)f.map(function(e){var t=s._getRandomNumber();e.key=t;var a=u.call(d,{tag:"button",type:e.type,className:e.className?e.className:t,label:e.label,expire:y});d.buttonsWrap.append(a)});else{var v=this._getRandomNumber(),b=Array.isArray(f)?f[0]:f,x=b.type,_=b.className,N=b.label;b.event;b.key=v;var g=u.call(this,{tag:"button",type:x,className:_||v,label:N,expire:y});this.buttonsWrap.append(g)}}else D.call(this);if(c&&p){var k,w,A,L=this.options.className+"_expire";if(this.expireWrap=u.call(this,{tag:"div",className:L+"_wrap",expire:c}),Array.isArray(p)){var C=this;p.map(function(e){var t=e.className,a=e.id,i=e.date,n=e.label;k=u.call(C,{tag:"p",className:L+"_box",expire:c}),w=u.call(C,{tag:"input",type:"checkbox",name:L+"_chk",className:t,id:a,label:i,expire:c}),A=u.call(C,{tag:"label",label:L+"_label",id:a,text:n,expire:c}),k.append(w,A),s.expireWrap.append(k)})}else k=u.call(this,{tag:"p",className:L+"_box",expire:c}),w=u.call(this,{tag:"input",type:"checkbox",className:L+"_chk",id:p.id,label:p.date,expire:c}),A=u.call(this,{tag:"label",label:L+"_label",id:p.id,text:p.label,expire:c}),k.append(w,A),this.expireWrap.append(k)}function D(){this.done=u.call(this,{tag:"button",className:t+"_button_done",type:"submit",label:"confirm",expire:c}),this.cancel=u.call(this,{tag:"button",className:t+"_button_cancel",label:"cancel",expire:c}),this.buttonsWrap.append(this.done,this.cancel)}this._setAttribute(),this._layoutAppend()}},{key:"_createElement",value:function(e){var t=e.tag,a=void 0===t?"div":t,i=e.id,n=e.className,s=e.name,o=e.type,r=void 0===o?"button":o,l=e.label,c=void 0===l?"버튼":l,p=e.src,u=e.text,h=e.expire,d=void 0!==h&&h,m=document.createElement(a);if(n){var f=n.split(",");1<f.length?f.map(function(e){return m.classList.add(e)}):m.classList.add(n)}return s&&(m.name=s),i&&"label"!==a&&(m.id=i),"label"===a&&u&&(m.innerText=u),"button"===a&&(m.setAttribute("type",""!==r?r:"button"),m.LayerPopup=this,m.innerText=""!==c?c:"버튼",p&&""!==p&&(m.style.backgroundImage="url("+p+")",m.classList.add("bg"))),d&&("radio"!==r&&"checkbox"!==r||(m.value=c,m.setAttribute("type",r),m.dataset.type="expired",m.LayerPopup=this),"label"===a&&m.setAttribute("for",i)),m}},{key:"_setAttribute",value:function(){var e=this.options.dim,t=this.wrap,a=t.style,i=t.dataset;a.zIndex=1e3,i.type="layerPopup",e&&(this.dim.dataset.type="dim")}},{key:"_layoutAppend",value:function(){var e=this.options,t=e.appendPosition,a=e.title,i=e.dim,n=e.closeButton,s=e.button,o=e.expire,r=e.expireData;if(a&&this.header.append(this.title),n&&this.header.append(this.closeButton),this.container.append(this.content),o&&r&&this.footer.append(this.expireWrap),(s||o)&&this.footer.append(this.buttonsWrap),this.header&&this.wrapInner.append(this.header),this.wrapInner.append(this.container),(s||o)&&this.wrapInner.append(this.footer),this.wrap.append(this.wrapInner),this._setContent(),this._attachEvent(),""!==t){var l=document.querySelector(t);""!==l&&l||(l=document.querySelector("body")),l.append(this.wrap)}i&&this.dim&&document.body.append(this.dim)}},{key:"_setContent",value:function(){var e=this.options,t=e.title,a=e.content,i=a,n=a;function s(e,t,a){var i=1<arguments.length&&void 0!==t?t:"\n",n=2<arguments.length&&void 0!==a?a:"<br>";return e.split(i).join(n)}t&&("string"==typeof t?(n=s(t),this.title.innerHTML=n):this.title.append(n)),"string"==typeof a?(i=s(a),this.content.innerHTML=i):this.content.append(i)}},{key:"_attachEvent",value:function(){var e=this,a=this,t=this.options,i=t.closeButton,n=t.customButton,s=t.button,o=t.customButtonData,r=t.expire,l=t.expireData;if(i&&this.closeButton.addEventListener("click",function(){e.close()}),s){var c=this.buttonsWrap.childNodes;if(n)if(""===o)f.call(this);else if(1<o.length)Array.from(c).map(function(t){o.find(function(e){e.event&&"function"==typeof e.event?t.className!==e.key&&t.className!==e.className||(t.addEventListener("click",e.event),t.event=e.event):(console.log("event가 비어있습니다. 기본이벤트로 대체합니다."),e.event=a._handleDefaultClick)})});else{var p=o.event,u=c[0];Array.isArray(o)&&(p=o[0].event),p&&"function"==typeof p&&""!==p||(console.log("event가 비어있습니다. 기본이벤트로 대체합니다."),p=this._handleDefaultClick),u.event=p,u.addEventListener("click",p)}else f.call(this);if(r&&l){var h=this.expireWrap.childNodes;if(1<h.length){var d=function(e){var a=e.target,t=this.LayerPopup.expireWrap.childNodes;Array.from(t).map(function(e){var t=e.childNodes;Array.from(t).find(function(e){"input"===e.tagName.toLowerCase()&&e.id!==a.id&&(e.checked=!1)})})};Array.from(h).map(function(e){var t=e.childNodes;Array.from(t).find(function(e){"input"===e.tagName.toLowerCase()&&e.addEventListener("click",d)})})}}}else if(r&&l){if(1<l.length)return!1;var m=this.expireWrap.childNodes;Array.from(m[0].childNodes).map(function(e){e.addEventListener("click",function(e){var t=e.target;"input"===t.tagName.toLowerCase()&&(a._handleExpire(t.value),a.close())})})}function f(){var t=this;if(1<this.buttonsWrap.childNodes.length){var e=this.buttonsWrap.childNodes;Array.from(e).map(function(e){e.addEventListener("click",t._handleDefaultClick),e.event=t._handleDefaultClick})}}}},{key:"_handleDefaultClick",value:function(e){var t=e.target,a=t.LayerPopup,i=a.options,n=a.expireWrap,s=i.button,o=i.expire,r=i.expireData,l=0<t.classList.value.search("done");if(s&&a.callback&&""!==a.callback&&a.callback(l),o&&r){var c=n.childNodes;Array.from(c).map(function(e){var t=e.childNodes;Array.from(t).map(function(e){"input"===e.tagName.toLowerCase()&&e.checked&&l&&a._handleExpire(e.value)})})}a.close()}},{key:"_handleExpire",value:function(e){var t=this.options.className,a=this._getRandomNumber();this.uniqueName=t+a,this._setCookie(this.uniqueName,e)}},{key:"_getRandomNumber",value:function(){for(var e=(new Date).getMinutes(),t=0;t<4;t++)e+=String(Math.floor(9*Math.random()));return e}},{key:"_setBodyScroll",value:function(e){e?document.body.style.removeProperty("overflow"):document.body.style.overflow="hidden"}},{key:"_dettachEvent",value:function(){var e=this.buttonsWrap.childNodes;Array.from(e).map(function(e){e.removeEventListener("click",e.event)})}},{key:"_setCookie",value:function(e,t){var a=new Date;a.setDate(a.getDate()+Number(t)),document.cookie=this.uniqueName+"="+escape(e)+"; path=/; expires="+a.toUTCString()+";"}},{key:"_getCookie",value:function(e){var t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:null}},{key:"open",value:function(){if(this.uniqueName&&this._getCookie(this.uniqueName))console.log(this.uniqueName,"로 쿠키 적용 중입니다.");else{var e=this.options,t=e.dim;e.scroll||this._setBodyScroll(!1),function(){var e=document.querySelectorAll('[data-type="layerPopup"].on');e&&(this.wrap.classList.contains("on")||(this.wrap.style.zIndex=Number(this.wrap.style.zIndex)+Number(e.length)))}.call(this),t&&this.dim&&this.dim.classList.add("on"),this.wrap.classList.add("on")}}},{key:"close",value:function(a){var i,e,t=this.expireWrap,n=this.options,s=n.dim,o=n.scroll,r=n.expire,l=n.expireData;if(o||this._setBodyScroll(!0),this.wrap.style.zIndex=1e3,this.wrap.classList.remove("on"),s&&this.dim){var c=document.querySelectorAll('[data-type="layerPopup"]'),p=0;Array.from(c).map(function(e){e.classList.contains("on")||p++}),c.length===p&&this.dim.classList.remove("on")}if(r&&l){i=this,e=t.childNodes,Array.from(e).map(function(e){var t=e.childNodes;Array.from(t).map(function(e){"input"===e.tagName.toLowerCase()&&e.checked&&(e.checked=!1,a&&i._handleExpire(e.value))})})}}},{key:"remove",value:function(){document.querySelectorAll('[data-type="layerPopup"].on')&&this.dim.remove(),this._dettachEvent(),this.wrap.remove(),this.name,this.options,this.callback,this.dim,this.wrap,this.wrapInner,this.header,this.container,this.footer,this.content,this.title,this.closeButton,this.buttonsWrap,this.done,this.cancel,this.expireWrap,this.uniqueName=null}}]),a}();
//# sourceMappingURL=layerPopup.min.js.map
